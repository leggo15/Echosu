{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Beatmap Info</title>
        <link rel="stylesheet" href="{% static 'css/master.css' %}">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="{% static 'js/master.js' %}"></script>
    </head>
    <body>
        {% if user_profile %}
            <img src="{{ user_profile.profile_pic_url }}" alt="{{ user_profile.user.username }}'s profile picture">
        {% endif %}
        <div class="container">
            <form method="post" class="beatmap-form">
                {% csrf_token %}
                <label for="beatmap_id">Enter Beatmap ID:</label>
                <input type="text" id="beatmap_id" name="beatmap_id">
                <button type="submit">Get Info</button>
            </form>

            {% if error %}
                <p class="error">{{ error }}</p>
            {% endif %}

            {% if beatmap %}
                <div class="beatmap-display">
                    {% if beatmap.cover_image_url %}
                    <div class="beatmap-cover-container">
                        <img class="beatmap-cover" src="{{ beatmap.cover_image_url }}" alt="Cover Image">
                    </div>
                    {% endif %}
                    <div class="beatmap-details-container">
                        <div class="beatmap-title-artist">
                            <h2 class="title">{{ beatmap.title }} - [{{ beatmap.version }}] | id: {{ beatmap.id }}</h2>
                            <h3 class="artist">Artist: {{ beatmap.artist }}</h3>
                            <h3 class="mapper">Mapper: {{ beatmap.creator }}</h3>
                        </div>
                        <div class="beatmap-stats">
                            <span>Length: {{ beatmap.total_length }} </span>
                            <span>BPM: {{ beatmap.bpm }} </span>
                            <span>CS: {{ beatmap.cs }} </span>
                            <span>HP: {{ beatmap.hp_drain }}</span>
                            <span>OD: {{ beatmap.accuracy }}</span>
                            <span>AR: {{ beatmap.ar }}</span>
                            <span>SR: {{ beatmap.difficulty_rating }}</span>
                        </div>
                    </div>
                </div>
                <!-- Hidden field to store the current beatmap's ID -->
                <input type="hidden" id="current_beatmap_id" value="{{ beatmap.beatmap_id }}">

                <!-- Tag input field and suggestions list -->
                <button type="button" class="apply-tag-btn">Apply Tag</button>
                <input type="text" id="tag-input" placeholder="Enter tag"> 
                <ul id="tag-list"></ul>

                <div class="applied-tags">
                    Tags:
                    {% for tag in tags_with_counts %}
                        <span class="tag" data-tag-name="{{ tag.name }}" data-applied-by-user="{{ tag.is_applied_by_user }}">
                            {{ tag.name }} ({{ tag.apply_count }})
                        </span>
                    {% endfor %}
                </div>
                
                
            {% endif %}
        </div>
    </body>
</html>
