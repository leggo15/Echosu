<!-- _navbar.html -->
{% load static %}
{% load custom_tags %}
 

<!-- Display messages -->
{% if messages %}
<ul class="messages" style="position:fixed; top:60px; left:0; right:0; z-index:5000;">
    {% for message in messages %}
        <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}
<nav>
    <div class="nav-content">
        <!-- Hamburger menu icon -->
        <div class="hamburger-menu" id="hamburgerMenu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <!-- Navigation links and search form -->
        <div class="nav-links" id="navLinks">
            <a href="{% url 'home' %}" class="nav-logo" aria-label="Home">
                <img src="{% static 'images/orange_128x128.ico' %}" alt="Echo logo"><i>â€Ž echosu</i>
            </a>
            <a href="{% url 'home' %}" class="generic-nav-btn">Search</a>
            <a href="{% url 'about' %}" class="generic-nav-btn">About</a>
            <a href="{% url 'tag_library' %}" class="generic-nav-btn">Tag Library</a>
            <a href="{% url 'statistics' %}" class="generic-nav-btn">Statistics</a>

        </div>
        
        <div class="user-section">
            {% if user.is_authenticated %}
                <span> {{ userprofile.username }} </span>
                <img src="{{ user_profile.profile_pic_url }}" alt="Profile Picture" id="profileMenuButton">
                <div id="profileDropdown" class="dropdown-content">
                    <a href="{% url 'settings' %}">Settings</a>
                    {% if user|has_tag_edit_permission %}
                    <a href="{% url 'edit_tags' %}">Edit Tags</a>
                    {% elif user.is_superuser %}
                        <a href="{% url 'edit_tags' %}">Edit Tags</a>
                    {% endif %}
                    {% if user.is_superuser %}
                        <a href="{% url 'admin:index' %}">Admin Dashboard</a>
                    {% endif %}
                    <form method="post" action="{% url 'logout' %}">
                        {% csrf_token %}
                        <button type="submit">Logout</button>
                    </form>
                </div>
                {% else %}
                <span class="profile-picture-placeholder">Log in with osu!</span>
                <img src="{% static 'images/default.png' %}" alt="Profile Picture" id="profileMenuButton">
                <div id="profileDropdown" class="dropdown-content">
                    <a href="{{ osu_oauth_url }}">Login</a>
                </div>
            {% endif %}
        </div>
    </div>
</nav>
 
{# Floating Add-Beatmap quick form shown on all pages #}
<!-- Mobile/Tablet slide-out toggle for side panels -->
<button type="button" class="side-panels-toggle" id="sidePanelsToggle" aria-expanded="false" aria-label="Open tools" title="Open tools"><span>&lt;</span></button>

<div class="side-panels-container" id="sidePanels">
{% if user.is_authenticated %}
<form method="post" action="{% url 'quick_add_beatmap' %}" class="floating-add-beatmap" aria-label="Quick add beatmap">
  <header class="floating-add-header">Add beatmap</header>
  <div class="floating-add-body">
    {% csrf_token %}
    <input type="text" name="beatmap_input" placeholder="Add beatmap ID or URL..." aria-label="Add beatmap">
    <button type="submit" title="Add">Add</button>
  </div>
</form>
{% else %}
<form method="post" action="{% url 'quick_add_beatmap' %}" class="floating-add-beatmap" aria-label="Quick add beatmap">
  <header class="floating-add-header">Add beatmap</header>
  <div class="floating-add-body">
    <span class="">Log in to add beatmaps</span>
  </div>
</form>
{% endif %}

<!-- Bulk Download panel (always visible) -->
<section class="bulk-download-panel" aria-label="Bulk download">
  <header class="bulk-download-header">Bulk download</header>
  <div class="bulk-download-body">
    <div class="bulk-list-container">
      <ul id="bulkDownloadList" class="bulk-list" aria-live="polite"></ul>
    </div>
    <div class="bulk-download-footer">
      <span class="bulk-count">Maps: <strong id="bulkSelectedCount">0</strong></span>
      <div class="bulk-actions">
        <button type="button" id="bulkDirectAllBtn" class="generic_btn">Direct</button>
        <button type="button" id="bulkSelectAllBtn" class="generic_btn">Select All</button>
      </div>
    </div>
  </div>
</section>
</div>


